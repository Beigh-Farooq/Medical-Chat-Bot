<!DOCTYPE html>
<html>
<head>
    <title>Medical Chatbot</title>

    <!-- Bootstrap & Icons -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <!-- ===== MAIN BODY ===== -->
<div class="main-content">
    <h1>ü©∫ Medical Information Assistant</h1>
    <p>
        Get general medical information based on trusted medical documents.
        This chatbot is designed to help you understand symptoms and conditions.
    </p>
    <p class="disclaimer">
        ‚ö† This chatbot does not replace professional medical advice.
        Always consult a qualified healthcare professional.
    </p>
</div>

<!-- Floating Chat Icon -->
<div id="chat-toggle">
    <img src="https://cdn-icons-png.flaticon.com/512/4712/4712109.png">
    <div class="chat-tooltip">How can I help?</div>
</div>

<!-- Chat Window -->
<div class="chat-popup" id="chat-popup">
    <div class="card">
        <div class="card-header msg_head">
            <div class="d-flex align-items-center">
                <img src="https://cdn-icons-png.flaticon.com/512/4712/4712109.png" class="rounded-circle user_img">
                <div class="user_info">
                    <span>Medical Assistant</span>
                    <p>Ask health-related questions</p>
                </div>
                <span class="close-btn ml-auto">&times;</span>
            </div>
        </div>

        <div id="messageFormeight" class="card-body msg_card_body">
            <div class="bot-intro">
                <h6>üë©‚Äç‚öïÔ∏è Medical Information Chatbot</h6>
                <p>
                    I provide general medical information based on trusted documents.
                    Always consult a qualified doctor for medical advice.
                </p>
            </div>
        </div>

        <div class="card-footer">
            <form id="messageArea" class="input-group">
                <input type="text" id="text" name="msg"
                       placeholder="Type your message..."
                       autocomplete="off"
                       class="form-control type_msg"
                       required />
                <div class="input-group-append">
                    <button type="submit" class="input-group-text send_btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- JS -->
<script>
$(document).ready(function () {

    // Toggle chat open
    $("#chat-toggle").click(function () {
        $("#chat-popup").fadeIn();
        $(".chat-tooltip").hide();
    });

    // Close chat
    $(".close-btn").click(function () {
        $("#chat-popup").fadeOut();
        $(".chat-tooltip").fadeIn();
    });

    function scrollToBottom() {
        $("#messageFormeight").scrollTop($("#messageFormeight")[0].scrollHeight);
    }

    $("#messageArea").on("submit", function (event) {
        event.preventDefault();

        const rawText = $("#text").val();
        $("#text").val("");

        const userHtml = `
        <div class="d-flex justify-content-end mb-3">
            <div class="msg_cotainer_send">${rawText}</div>
        </div>`;
        $("#messageFormeight").append(userHtml);
        scrollToBottom();

        const typingHtml = `
        <div id="typing" class="d-flex justify-content-start mb-3">
            <div class="typing-indicator">
                <span></span><span></span><span></span>
            </div>
        </div>`;
        $("#messageFormeight").append(typingHtml);
        scrollToBottom();

        $.ajax({
            type: "POST",
            url: "/get",
            data: { msg: rawText },
        }).done(function (data) {
            $("#typing").remove();

            const botHtml = `
            <div class="d-flex justify-content-start mb-3">
                <div class="msg_cotainer">${data}</div>
            </div>`;
            $("#messageFormeight").append(botHtml);
            scrollToBottom();
        });
    });
});
</script>

</body>
</html>
